/**
 * angular-dc
 * @version v0.0.8 - 2017-08-26
 * @link https://github.com/TomNeyland/angular-dc
 * @author Tom Neyland <>
 * @license Apache License, http://www.opensource.org/licenses/Apache
 */
!function(a,b){"function"==typeof define&&define.amd?define(["angular","dc","lodash","d3"],function(c,d,e,f){return a.angularDc=b(c,d,e,f)}):"object"==typeof module&&module.exports?module.exports=b(require("angular"),require("dc"),require("lodash"),require("d3")):a.angularDc=b(a.angular,a.dc,a._,a.d3)}(this,function(a,b,c,d){"use strict";var e=a.module("angularDc",[]);return e.directive("dcChart",["$timeout",function(c){function e(a,c,d){var e=c[0],h=d.dcChart,i=d.dcChartGroup||void 0,j=b[h],k=j(e,i),l=f(k),m=g(a,d,l);"options"in m&&(m=_.merge(m,m.options),m.options=void 0),"name"in m&&(a[m.name]=k,m.name=void 0),k.options(m);var n=_({renderlet:m.onRenderlet,preRender:m.onPreRender,postRender:m.onPostRender,preRedraw:m.onPreRedraw,postRedraw:m.onPostRedraw,filtered:m.onFiltered,zoomed:m.onZoomed}).omit(_.isUndefined);return n.each(function(a,b){k.on(b,a)}),_.isFunction(m.postSetupChart)&&m.postSetupChart(k,m),k}function f(a){return _(a).functions().value().concat(h).map(function(a){return"dc"+a.charAt(0).toUpperCase()+a.substring(1)})}function g(a,b,c){return _(b.$attr).keys().intersection(c).reduce(function(c,d){var e=a.$eval(b[d]);return"dc"===d.substring(0,2)&&(d=d.charAt(2).toLowerCase()+d.substring(3)),c[d]=e,c},{})}var h=["name","onRenderlet","onFiltered","onPostRedraw","onPostRender","onPreRedraw","onPreRender","onZoomed","postSetupChart"];return{restrict:"A",link:function(f,g,h){var i=!1;f.dc=b,f.d3=d,f.DateTime=function(a,b,c,d,e,f){return new Date(a,b,c,d,e,f)},f.Date=function(a,b,c){return new Date(a,b,c)};var j=f.$watch(function(){var a=_(h.$attr).keys().filter(function(a){return"dc"===a.substring(0,2)&&"dcChart"!==a&&"dcChartGroup"!==a}).map(function(a){try{var b=f.$eval(h[a]);if(_.isUndefined(b))throw new Error(h[a]+" is undefined");return b}catch(c){if(i)throw console.log("unable to eval"+a+":"+h[a]),c;return void 0}});return a.some(_.isUndefined)?void 0:a.value()},function(c){if(!_.isUndefined(c)){j();var d=e(f,g,h),i=a.element(g[0].querySelector("a.reset"));i.on("click",function(){d.filterAll(),b.redrawAll()}),i.attr("href","javascript:;"),i.css("display","none"),d.render()}});c(function(){i=!0},2e3)}}}]),e.directive("dcSelect",[function(){return{restrict:"E",scope:{dcDimension:"=",allLabel:"@"},template:'<select class="form-control" ng-model="selectModel" ng-options="d.key for d in selectOptions">',link:function(a,c,d){return a.$watch("dcDimension",function(c){var d,e;"undefined"!=typeof c&&null!==c&&(e=b.baseMixin({}),e.dimension(c),e.group(c),e._doRender=function(){},e._doRedraw=function(){},a.selectModel={key:a.allLabel},d=c.group().orderNatural().all(),a.selectOptions=[a.selectModel].concat(d))}),a.$watch("selectModel",function(c){"undefined"!=typeof a.dcDimension&&null!==a.dcDimension&&(null!==c&&c.key!==a.allLabel?a.dcDimension.filter(function(a){return a===c.key}):a.dcDimension.filter(null),b.redrawAll())})}}}]),e});